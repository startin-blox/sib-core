<script type="text/javascript" src="https://cdn.happy-dev.fr/LDP-framework/ldpframework.js"></script>
<base href="https://polygit.org/components/">
<link rel="import" href="polymer/polymer-element.html" rel="import">
<link rel="import" href="polymer/lib/elements/dom-repeat.html">
<link rel="import" href="polymer/lib/elements/dom-if.html">

<dom-module id="ldp-display">
    <template>
        <template is="dom-if" if="{{resource.ldp:contains}}">
            <template is="dom-repeat" items="{{resource.ldp:contains}}">
                <div>
                    <ldp-display resource="{{item}}"></ldp-display>
                </div>
            </template>
        </template>
        <template is="dom-if" if="{{!resource.ldp:contains}}">
            <template is="dom-repeat" items="{{getFields(resource)}}">
                <div>{{getField(resource, item)}}</div>
            </template>
        </template>
    </template>

    <script>
    window.store = new MyStore({context: "http://owl.openinitiative.com/oicontext.jsonld"});
    class LDPDisplay extends Polymer.Element {
        static get is() { return 'ldp-display'; }
        getFields(resource) {
            return Object.keys(resource).filter(function(prop){return !prop.startsWith("@")});
        }
        getField(resource, field) {
            return resource[field];
        }
        attributeChangedCallback(attribute, oldValue, newValue) {
            if(attribute == "data-src" && src) store.get(src).then(function(resource) {
                this.resource = resource;
            }.bind(this));
        }
    }

    customElements.define(LDPDisplay.is, LDPDisplay);
    </script>
</dom-module>
