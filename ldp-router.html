<base href="https://polygit.org/components/">
<link rel="import" href="polymer/polymer-element.html">

<script>
(function(){
    class LDPRoute extends Polymer.Element {
        get name() {
            return this.getAttribute('name');
        }
        set name(name) {
            this.setAttribute('name', name);
        }
        connectedCallback() {
            this.addEventListener('click', function(event) {
                this.closest('ldp-router').navigate(this.name);
            }.bind(this));
        }
    }
    
    class LDPRouter extends HTMLElement {
        constructor() {
            super();
            if(document.readyState=="complete")window.addEventListener('WebComponentsReady', event => this.display());
            else document.addEventListener("DOMContentLoaded", event => this.display());
        }
        display(name) {
            name = name || window.location.hash.replace('#', '') || this.getAttribute('default-route');
            for(let route of this.querySelectorAll('ldp-route')) {
                const page = document.getElementById(route.name);
                if(page) {
                    if(route.name == name) {
                        page.style.display = 'block';
                        route.setAttribute('active', '');
                    } else {
                        page.style.display = 'none';
                        route.removeAttribute('active');
                    }
                }
            }
        }
        navigate(name) {
            name = name || '';
            this.display(name);
            window.location.hash = name;
        }
    }
    
    customElements.define('ldp-router', LDPRouter);
    customElements.define('ldp-route', LDPRoute);
}());
</script>
