<link rel="import" href="./ldp-base.html">
<link rel="import" href="./ldp-widgets.html">

<dom-module id="ldp-display">
    <template>
        <template is="dom-if" if="{{isContainer(resource)}}">
            <template is="dom-repeat" items="{{listResources(resource)}}">
                <div on-click="dispatchSelect">
                    <ldp-insert tag="{{childTag()}}" resource="{{item}}" fields="{{fields}}" widgets="{{widgets}}"></ldp-insert>
                </div>
            </template>
        </template>
        <template is="dom-if" if="{{!isContainer(resource)}}">
            <ldp-list-fields resource="{{resource}}" fields="{{fields}}" widgets="{{widgets}}" default-widget="ldp-display-div"></ldp-list-fields>
        </template>
    </template>

    <script>
    (function(){
        class LDPDisplay extends LDPBase {
            static get is() { return 'ldp-display'; }
            
            childTag() {
                return this.dataset.child || this.tagName;
            }
            dispatchSelect(event) {
                var resource = event.currentTarget.querySelector('ldp-display').resource; //TODO won't work with custom child
                this.dispatchEvent(new CustomEvent('select', {detail: {resource: resource}}));
            }
        }

        customElements.define(LDPDisplay.is, LDPDisplay);
    }());
    </script>
</dom-module>
